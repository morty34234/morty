{% extends 'events/base.html' %}

{% block content %}
<div class="event-detail">
    {% if is_past %}
    <div class="past-event-badge">‚è≥ –≠—Ç–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ —É–∂–µ –ø—Ä–æ—à–ª–æ</div>
    {% endif %}

    {% if event.image %}
    <img src="{{ event.image.url }}" alt="{{ event.title }}" class="event-detail-image">
    {% endif %}

    <span class="event-type">{{ event.get_event_type_display }}</span>

    <h1>{{ event.title }}</h1>

    <div class="event-detail-meta">
        <p><strong>üìÖ –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</strong> {{ event.date|date:"d.m.Y H:i" }}</p>
        <p><strong>üìç –ú–µ—Å—Ç–æ:</strong> {{ event.location }}</p>
        <p><strong>üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {% if event.price > 0 %}{{ event.price }} —Ä—É–±.{% else %}–ë–µ—Å–ø–ª–∞—Ç–Ω–æ{% endif %}</p>
        <p><strong>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</strong> {{ event.get_comments_count }}</p>
    </div>

    <div class="event-detail-description">
        <h3>–û–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h3>
        <p>{{ event.description|linebreaks }}</p>
    </div>

    <a href="{% if is_past %}{% url 'past_events' %}{% else %}{% url 'index' %}{% endif %}" class="btn">
        ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
    </a>
</div>

<div class="comments-section">
    <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ comments.count }})</h3>

    {% if user.is_authenticated %}
    <div class="comment-form-container">
        <form method="post" class="comment-form">
            {% csrf_token %}
            <input type="hidden" name="comment" value="1">
            <div class="form-group">
                <textarea name="text" rows="4" placeholder="–í–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." class="form-control"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</button>
        </form>
    </div>
    {% else %}
    <div class="auth-required">
        <p>–ß—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, <a href="{% url 'login' %}">–≤–æ–π–¥–∏—Ç–µ</a> –≤ –∞–∫–∫–∞—É–Ω—Ç.</p>
    </div>
    {% endif %}

    <div class="comments-list">
        {% for comment in comments %}
        <div class="comment-item">
            <div class="comment-header">
                <div class="comment-author">
                    <strong>{{ comment.author.username }}</strong>
                </div>
                <div class="comment-date">
                    {{ comment.created_at|date:"d.m.Y H:i" }}
                </div>
            </div>
            <div class="comment-text">
                {{ comment.text|linebreaks }}
            </div>
        </div>
        {% empty %}
        <div class="no-comments">
            <p>–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}